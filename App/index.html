<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Cadastro de Ensaios - Guarulhos</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; padding: 50px; }
        .form-container { border: 1px solid #ccc; padding: 20px; border-radius: 8px; }
        input { padding: 8px; margin-right: 10px; border: 1px solid #ddd; border-radius: 4px; }
        button { padding: 8px 16px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; }
    </style>
</head>
<body>

<div class="form-container">
    <h3>Receba notificações dos ensaios</h3>
    <form id="emailForm">
        <input type="email" id="emailInput" placeholder="Seu melhor e-mail" required>
        <button type="submit" id="btnEnviar">Cadastrar</button>
    </form>
    <p id="mensagem"></p>
</div>

<script>
    // Substitua pela URL que aparecerá no seu terminal após o 'terraform apply'
    const API_URL = "https://8v6vbvy0k3.execute-api.us-east-1.amazonaws.com/cadastro";

    document.getElementById('emailForm').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const email = document.getElementById('emailInput').value;
        const mensagem = document.getElementById('mensagem');
        const btn = document.getElementById('btnEnviar');

        // Feedback visual
        btn.disabled = true;
        mensagem.innerText = "Enviando...";

        try {
            const response = await fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email: email })
            });

            if (response.ok) {
                mensagem.style.color = "green";
                mensagem.innerText = "E-mail cadastrado com sucesso!";
                document.getElementById('emailInput').value = "";
            } else {
                throw new Error('Erro no servidor');
            }
        } catch (error) {
            mensagem.style.color = "red";
            mensagem.innerText = "Erro ao cadastrar. Tente novamente.";
            console.error(error);
        } finally {
            btn.disabled = false;
        }
    });
</script>

</body>
</html>